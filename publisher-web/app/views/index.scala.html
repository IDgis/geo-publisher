@(dataSources: nl.idgis.publisher.domain.response.Page[nl.idgis.publisher.domain.web.DataSource],
	notifications: nl.idgis.publisher.domain.response.Page[nl.idgis.publisher.domain.web.DashboardNotification],
	tasks: nl.idgis.publisher.domain.response.Page[nl.idgis.publisher.domain.web.DashboardActiveTask],
	errors: nl.idgis.publisher.domain.response.Page[nl.idgis.publisher.domain.web.DashboardError]
)

@import org.joda.time.LocalDateTime

@dateTimeToMessage(date: LocalDateTime) = {
	1 dag geleden
}


@layout.application(title = "GIS publicatieomgeving", jsMain = routes.Assets.at("js/dashboard/main.js").url) {

	<div class="jumbotron">
		<div class="row">
			<div class="col-lg-8">
				<h1>GIS publicatieomgeving</h1>
			</div>
			<div class="col-lg-2">
				<div class="well">
					<a href="http://www.idgis.nl">
						<img class="img-responsive" alt="IDgis" src="@routes.Assets.at("images/logo-idgis-large.png")">
					</a>
				</div>
			</div>
		</div>
	</div>
	
	<div class="page-content">
		<div class="row">
			<!-- DATASOURCES -->
			<div class="col-lg-3">
				@if(dataSources.values.size == 0){
					<div class="panel panel-warning">
				}else{
					<div class="panel panel-success">
				}
					<div class="panel-heading">
						<div class="row">
							<div class="col-xs-4">
								<p class="announcement-heading">
									<span class="glyphicon glyphicon-cloud"></span>
								</p>
							</div>
							<div class="col-xs-8 text-right">
								<p class="announcement-heading">
									@if(dataSources.values.isEmpty) {
										geen
									} else {
										@dataSources.values.size
									}
								</p>
								<p class="announcement-text">
									Actieve gegevensbron@if(dataSources.values.size != 1){nen}
								</p>
							</div>
						</div>
					</div>
					<ul class="list-group">
						@for(dataSource <- dataSources.values) {
							<li class="list-group-item">
								<div>
									<strong>@dataSource.name</strong>
								</div>
								<div>
									@helper.status(dataSource.status)
								</div>
							</li>
						}
					</ul>
					<a href="@routes.DataSources.list()">
						<div class="panel-footer">
							<div class="row">
								<div class="col-xs-10">
									Bekijk status
								</div>
								<div class="col-xs-2 text-right">
									<span class="glyphicon glyphicon-circle-arrow-right"></span>
								</div>
							</div>
						</div>
					</a>
				</div>
			</div>
					
			<!-- NOTIFICATIONS -->
			<div class="col-lg-3">
				<div class="panel panel-info">
					<div class="panel-heading">
						<div class="row">
							<div class="col-xs-6">
								<p class="announcement-heading">
									<span class="glyphicon glyphicon-bell"></span>
								</p>
							</div>
							<div class="col-xs-6 text-right">
								<p class="announcement-heading">
									@if(notifications.values.isEmpty) {
										geen
									} else {
										@notifications.values.size
									}
								</p>
								<p class="announcement-text">
									Melding@if(notifications.values.size != 1){en}
								</p>
							</div>
						</div>
					</div>
					<ul class="list-group">
						@for(notification <- notifications.values) {
							<li class="list-group-item">
								<a href="#">
									@notification.message: @notification.datasetName
								</a>
							</li>
						}
					</ul>
					<a href="@routes.Datasets.listWithMessages()">
						<div class="panel-footer">
							<div class="row">
								<div class="col-xs-10">
									Alle datatasets met meldingen
								</div>
								<div class="col-xs-2 text-right">
									<span class="glyphicon glyphicon-circle-arrow-right"></span>
								</div>
							</div>
						</div>
					</a>
				</div>
			</div>
			
			<!-- ACTIVE TASKS -->
			<div class="col-lg-3">
				<div class="panel panel-success">
					<div class="panel-heading">
						<div class="row">
							<div class="col-xs-6">
								<p class="announcement-heading">
									<span class="glyphicon glyphicon-tasks"></span>
								</p>
							</div>
							<div class="col-xs-6 text-right">
								<p class="announcement-heading">
									@if(tasks.values.isEmpty) {
										geen
									} else {
										@tasks.values.size
									}
								</p>
								<p class="announcement-text">
									Actieve @if(tasks.values.size != 1){taken}else{taak}
								</p>
							</div>
						</div>
					</div>
					<ul class="list-group">
						@for(task <- tasks.values) {
							<li class="list-group-item">
								<div>
									<strong>@task.datasetName</strong>
									<span class="pull-right text-muted">@task.message</span>
								</div>
								<div class="progress progress-striped active">
									<div class="progress-bar progress-bar-success" role="progressbar" 
									  aria-valuenow="@task.progress" aria-valuemin="0" aria-valuemax="100" style="width: @task.progress%">
									  @task.progress%
									</div>
								</div>
							</li>
						}
						
					</ul>
					<a href="#">
						<div class="panel-footer">
							<div class="row">
								<div class="col-xs-10">
									Bekijk logboek
								</div>
								<div class="col-xs-2 text-right">
									<span class="glyphicon glyphicon-circle-arrow-right"></span>
								</div>
							</div>
						</div>
					</a>
				</div>
			</div>
			
			<!-- ERRORS  -->
			<div class="col-lg-3">
				<div class="panel panel-warning">
					<div class="panel-heading">
						<div class="row">
							<div class="col-xs-6">
								<p class="announcement-heading">
									<span class="glyphicon glyphicon-warning-sign"></span>
								</p>
							</div>
							<div class="col-xs-6 text-right">
								<p class="announcement-heading">
									@if(errors.values.isEmpty) {
										geen
									} else {
										@errors.values.size
									}
								</p>
								<p class="announcement-text">
									Foutmelding@if(errors.values.size != 1){en}
								</p>
								
							</div>
						</div>
					</div>
					<ul class="list-group">
						@for(error <- errors.values) {
							<li class="list-group-item">
							<div>
								<p>
									<strong>@error.message</strong>
									<span class="pull-right">@dateTimeToMessage(error.dateTime)</span>
								</p>
							</div>
							<p>
								<span class="text-muted">Dataset</span> @error.datasetName  
							</p>
							</li>
						}
					</ul>
					<a href="#">
						<div class="panel-footer">
							<div class="row">
								<div class="col-xs-10">
									Bekijk foutlogboek
								</div>
								<div class="col-xs-2 text-right">
									<span class="glyphicon glyphicon-circle-arrow-right"></span>
								</div>
							</div>
						</div>
					</a>
				</div>
			</div>
		</div>
	</div>
}
