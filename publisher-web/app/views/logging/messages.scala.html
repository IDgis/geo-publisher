@(issues: nl.idgis.publisher.domain.response.Page[nl.idgis.publisher.domain.web.Issue], logLevels: Set[nl.idgis.publisher.domain.job.LogLevel])

@import nl.idgis.publisher.domain.job.LogLevel


@logLevelLink(label: String, logLevel: LogLevel) = {
	@if(logLevels.contains(logLevel)) {
		@if(logLevels.size == 1) {
			<a class="disabled" href="@routes.Logging.messagesWithFilter(controllers.Logging.logLevels(logLevels), issues.currentPage)"><span class="glyphicon glyphicon-check"></span> @label</a>
		} else {
			<a href="@routes.Logging.messagesWithFilter(controllers.Logging.logLevelsWithout(logLevels, logLevel), 1)"><span class="glyphicon glyphicon-check"></span> @label</a>
		}
	} else {
		<a href="@routes.Logging.messagesWithFilter(controllers.Logging.logLevelsWith(logLevels, logLevel), 1)"><span class="glyphicon glyphicon-unchecked"></span> @label</a>
	}
}

@pageRef(targetPage: Long) = @{
	routes.Logging.messagesWithFilter (controllers.Logging.logLevels(logLevels), targetPage)	  
}

@layout.application(
	title = "Logboek - Foutmeldingen",
	jsMain = routes.Assets.at("js/logging/main.js").url
) {
	<div class="page-content">
		<h1 class="page-header">Foutmeldingen</h1>
		
		<div class="row">
			
			@* Filters: *@
			<div class="col-lg-3 col-lg-push-9">
				<div class="panel-group" id="filters-accordion">
				
					@* Loglevel: *@
					<div class="panel panel-default">
						<div class="panel-heading">
							<h4 class="panel-title">
								<a data-toggle="collapse" data-parent="#filters-accordion" href="#collapse-filter-loglevel">
									Soort melding
								</a>
							</h4>
						</div>
						<div id="collapse-filter-loglevel" class="panel-collapse collapse in">
							<div class="panel-body">
								<ul class="nav nav-pills nav-stacked">
									<li>@logLevelLink("Fout", LogLevel.ERROR)</li>
									<li>@logLevelLink("Waarschuwing", LogLevel.WARNING)</li>
									<li>@logLevelLink("Informatie", LogLevel.INFO)</li>
									<li>@logLevelLink("Technische informatie", LogLevel.DEBUG)</li>
								</ul>
							</div>
						</div>
					</div>
					
				</div>
				
			</div>
			
			@* List of log messages: *@
			<div class="col-lg-9 col-lg-pull-3">
				@if(issues.values.isEmpty) {
					<div class="alert alert-info">
						Er zijn geen meldingen gevonden die voldoen aan de criteria. Pas de criteria aan
						of toon <a href="@routes.Logging.messages()">alle meldingen</a>.
					</div>
				} else {
					@helper.pagination(issues, pageRef)
					<ul>
					@for(issue <- issues.values) {
						<li>@issue.when - @Domain.message(issue.message)</li>
					}
					</ul>
					@helper.pagination(issues, pageRef)
				} 
			</div>
			
		</div>
	</div>
}